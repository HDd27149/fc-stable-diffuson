"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[448],{68996:function(pe,W,e){e.d(W,{r:function(){return r}});var K=e(97857),i=e.n(K),j=e(86074);function r(U){var v=U.disabled,le=U.children,C=U.message;return(0,j.jsxs)("div",{style:i()({position:"relative"},v?{cursor:"not-allowed",display:"block",maxHeight:"100vh",overflow:"hidden"}:{}),children:[v&&(0,j.jsx)("div",{style:{position:"absolute",fontWeight:"bold",zIndex:1,transform:"translate(0, -50%)",top:"50%",left:0,right:0,textAlign:"center"},children:C||"\u60A8\u672A\u6302\u8F7D NAS\uFF0C\u65E0\u6CD5\u5F00\u542F\u6587\u4EF6\u7BA1\u7406\u529F\u80FD\u3002"}),(0,j.jsx)("div",{style:v?{pointerEvents:"none",filter:"opacity(0.5) grayscale(1)"}:{},children:le})]})}},68797:function(pe,W,e){e.d(W,{Q:function(){return de}});var K=e(97857),i=e.n(K),j=e(15009),r=e.n(j),U=e(99289),v=e.n(U),le=e(5574),C=e.n(le),se=e(36147),ce=e(71577),ue=e(62435),D=e(86074);function de(Q){var te=Q.modalProps,p=Q.buttonProps,Y=Q.children,fe=Q.beforeRequest,G=Q.afterRequest,ne=Q.request,J=Q.setVisibleCallback,he=ue.useState(!1),xe=C()(he,2),Te=xe[0],ve=xe[1];return ue.useEffect(function(){J&&J(ve)},[ve]),(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(se.Z,i()(i()({open:Te,onCancel:function(){return ve(!1)},maskClosable:!0,destroyOnClose:!0,onOk:v()(r()().mark(function O(){var m;return r()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(ne){f.next=2;break}return f.abrupt("return");case 2:return fe&&fe(),f.prev=3,f.next=6,ne();case 6:m=f.sent,m.success?(G&&G(!0),ve(!1)):G&&G(!1,"".concat(m.errMsg)),f.next=13;break;case 10:f.prev=10,f.t0=f.catch(3),G&&G(!1,"".concat(f.t0));case 13:case"end":return f.stop()}},O,null,[[3,10]])})),okButtonProps:ne?{}:{style:{display:"none"}}},te),{},{children:Te&&Y})),(0,D.jsx)(ce.ZP,i()({onClick:function(){return ve(!0)}},p))]})}},25864:function(pe,W,e){e.d(W,{E:function(){return Q}});var K=e(92380),i=e(85504),j=e(53371),r=e(90105),U=e(18629),v=e(42075),le=e(26196),C=e(94139),se=e(69814),ce=e(77794),ue=e(62435),D=e(86074);function de(te){var p=te.task,Y=p.getFileName(),fe=Math.round(p.getProgress()*1e4)/100,G=p.getCurrent(),ne=p.getTotal(),J=p.getError(),he=p.isFinished();return(0,D.jsxs)(v.Z,{direction:"vertical",style:{width:"100%"},children:[(0,D.jsxs)(v.Z,{style:{width:"100%",justifyContent:"space-between"},children:[(0,D.jsx)(le.Z.Text,{strong:!0,children:(0,D.jsx)(C.Z,{title:Y,children:(0,j.Us)(Y)})}),(0,D.jsxs)("span",{children:[(0,K.t)(G)," / ",(0,K.t)(ne)]})]}),(0,D.jsx)(se.Z,{percent:fe,status:J?"exception":he?"success":void 0}),J&&(0,D.jsx)("span",{style:{color:"red"},children:J})]})}function Q(){var te=ue.useContext(i._),p=te.tasks,Y=r.Z();return U.Z(Y,200),(0,D.jsx)(ce.Z,{header:(0,D.jsx)("span",{style:{color:"#ed7075"},children:"\u4E0A\u4F20\u8FC7\u7A0B\u4E2D\u8BF7\u52FF\u5237\u65B0\u9875\u9762"}),dataSource:p,renderItem:function(G){return(0,D.jsx)(ce.Z.Item,{children:(0,D.jsx)(de,{task:G})})},locale:{emptyText:"\u6682\u65E0\u4E0A\u4F20\u4EFB\u52A1"}})}},56153:function(pe,W,e){e.r(W),e.d(W,{default:function(){return st}});var K=e(97857),i=e.n(K),j=e(15009),r=e.n(j),U=e(99289),v=e.n(U),le=e(5574),C=e.n(le),se=e(70507);function ce(n){return ue.apply(this,arguments)}function ue(){return ue=v()(r()().mark(function n(s){var a;return r()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,se.Z.get("/api/file/list?path=".concat(s));case 2:return a=u.sent,u.abrupt("return",a.data);case 4:case"end":return u.stop()}},n)})),ue.apply(this,arguments)}function D(n){return de.apply(this,arguments)}function de(){return de=v()(r()().mark(function n(s){var a;return r()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,se.Z.delete("/api/file?path=".concat(s));case 2:return a=u.sent,u.abrupt("return",a.data);case 4:case"end":return u.stop()}},n)})),de.apply(this,arguments)}function Q(n){return te.apply(this,arguments)}function te(){return te=_asyncToGenerator(_regeneratorRuntime().mark(function n(s){var a;return _regeneratorRuntime().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,axios.put("/api/folder",null,{params:{path:s}});case 2:return a=u.sent,u.abrupt("return",a.data);case 4:case"end":return u.stop()}},n)})),te.apply(this,arguments)}function p(n,s){return Y.apply(this,arguments)}function Y(){return Y=v()(r()().mark(function n(s,a){var h;return r()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,se.Z.post("/api/file/move",null,{params:{src:s,dst:a}});case 2:return h=l.sent,l.abrupt("return",h.data);case 4:case"end":return l.stop()}},n)})),Y.apply(this,arguments)}function fe(n,s){return G.apply(this,arguments)}function G(){return G=v()(r()().mark(function n(s,a){var h;return r()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,se.Z.post("/api/file/copy",null,{params:{src:s,dst:a}});case 2:return h=l.sent,l.abrupt("return",h.data);case 4:case"end":return l.stop()}},n)})),G.apply(this,arguments)}var ne=e(92380),J=e(85504),he=e(9957),xe=e(71965),Te=e(93613),ve=e(26911),O=e(19478),m=e(57132),$=e(48689),f=e(57213),k=e(22821),x=e(83204),o=e(33009),R=e(42075),S=e(79531),y=e(71577),I=e(77794),ge=e(71230),Z=e(15746),ie=e(26196),H=e(76306),d=e(62435),ye=e(68996),Re=e(51904),Be=e(13769),Fe=e.n(Be),M=e(53371),be=e(83266),Me=e(68797),t=e(86074),Ue=["dir","beforeRequest","afterRequest"];function Ie(n){var s=n.dir,a=n.beforeRequest,h=n.afterRequest,u=Fe()(n,Ue),l=d.useState("newfolder_".concat(Date.now()%1e3)),E=C()(l,2),g=E[0],F=E[1];return(0,t.jsx)(Me.Q,{modalProps:{title:"\u65B0\u5EFA\u6587\u4EF6\u5939",okText:"\u521B\u5EFA"},buttonProps:i()({icon:(0,t.jsx)(be.Z,{}),title:"\u65B0\u5EFA\u6587\u4EF6\u5939"},u),beforeRequest:a,afterRequest:h,request:v()(r()().mark(function P(){return r()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,D((0,M.Dy)(s,g));case 2:return c.abrupt("return",c.sent);case 3:case"end":return c.stop()}},P)})),children:(0,t.jsx)(S.Z,{addonBefore:(0,M.Dy)(s,"/"),value:g,onChange:function(A){var c;return F((A==null||(c=A.target)===null||c===void 0?void 0:c.value)||"")},style:{width:"100%"}})})}var Le=e(56334),we=["pasteType","src","dstDir","beforeRequest","afterRequest"];function We(n){var s=n.pasteType,a=n.src,h=n.dstDir,u=n.beforeRequest,l=n.afterRequest,E=Fe()(n,we),g=d.useState(""),F=C()(g,2),P=F[0],A=F[1];return d.useEffect(function(){return A((0,M.Us)(a))},[a]),(0,t.jsx)(Me.Q,{modalProps:{title:"".concat(s==="copy"?"\u590D\u5236":s==="cut"?"\u79FB\u52A8":"\u7C98\u8D34","\u6587\u4EF6"),okText:"\u7C98\u8D34"},buttonProps:i()({icon:(0,t.jsx)(Le.Z,{})},E),beforeRequest:u,afterRequest:l,request:v()(r()().mark(function c(){return r()().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return L.next=2,(s==="cut"?p:fe)(a,(0,M.Dy)(h,P));case 2:return L.abrupt("return",L.sent);case 3:case"end":return L.stop()}},c)})),children:(0,t.jsxs)(R.Z,{direction:"vertical",style:{width:"100%"},children:[(0,t.jsx)(S.Z,{value:a,disabled:!0,style:{width:"100%"},addonBefore:"\u539F\u59CB\u6587\u4EF6"}),(0,t.jsx)(S.Z,{addonBefore:"\u76EE\u6807\u6587\u4EF6",prefix:(0,M.Dy)(h,"/"),value:P,onChange:function(T){var L;return A((T==null||(L=T.target)===null||L===void 0?void 0:L.value)||"")},style:{width:"100%"}})]})})}var Ke=e(19632),Ae=e.n(Ke),ze=e(4393),Ne=e(68955),ke=e(43331),Ge=e(64082),$e=e(50888),Se=e(88484),Ve=e(2058);function Qe(n){var s,a=n.folder,h=d.useState([]),u=C()(h,2),l=u[0],E=u[1],g=d.useState(""),F=C()(g,2),P=F[0],A=F[1],c=k.Z(!1),T=C()(c,2),L=T[0],Pe=T[1],oe=Pe.setTrue,Ee=Pe.setFalse,De=d.useMemo(function(){return P.trim()?a||/^(\/mnt\/.+)|(^\/tmp\/.+)/.test(P)?"":"\u6587\u4EF6\u53EA\u5141\u8BB8\u4E0A\u4F20\u81F3 /mnt/ \u53CA /tmp/ \u76EE\u5F55":"\u6587\u4EF6\u540D\u4E0D\u80FD\u4E3A\u7A7A"},[P]),X=l==null||(s=l[0])===null||s===void 0?void 0:s.originFileObj;d.useEffect(function(){X&&A(X.name)},[X]);var Oe=d.useContext(J._);return(0,t.jsxs)(R.Z,{direction:"vertical",style:{width:"100%"},styles:{item:{width:"100%"}},children:[(0,t.jsxs)(Ve.Z.Dragger,{disabled:L,maxCount:1,customRequest:function(){},fileList:[],onChange:function(V){return E(V.fileList)},onRemove:function(){return!1},showUploadList:{showRemoveIcon:!1,showPreviewIcon:!1,showDownloadIcon:!1},progress:{strokeColor:{"0%":"#108ee9","100%":"#87d068"},strokeWidth:3,format:function(V){return V?"".concat(parseFloat(V.toFixed(2)),"%"):""}},children:[(0,t.jsx)(Ge.Z,{style:{fontSize:18,marginRight:"0.5em"}}),X?X.name:"\u62D6\u62FD\u6216\u9009\u62E9\u6587\u4EF6"]}),(0,t.jsxs)(R.Z.Compact,{style:{width:"100%"},children:[(0,t.jsx)(S.Z,{value:P,disabled:L,addonBefore:"\u6587\u4EF6\u540D",prefix:a||void 0,suffix:(0,t.jsx)("span",{children:L&&(0,t.jsx)($e.Z,{})}),onChange:function(V){var je;return typeof((je=V.target)===null||je===void 0?void 0:je.value)!="undefined"&&A(V.target.value)},placeholder:"\u8BF7\u8F93\u5165\u6587\u4EF6\u540D"}),(0,t.jsx)(y.ZP,{type:"primary",icon:(0,t.jsx)(Se.Z,{}),disabled:L||!!De,onClick:v()(r()().mark(function re(){var V;return r()().wrap(function(me){for(;;)switch(me.prev=me.next){case 0:if(X){me.next=2;break}return me.abrupt("return");case 2:oe(),V=new ke.Vz(X,P),V.run(),Oe.setCtx(function(ae){return i()(i()({},ae),{},{tasks:[].concat(Ae()((ae==null?void 0:ae.tasks)||[]),[V])})}),o.Z.success({message:"\u5F00\u59CB\u4E0A\u4F20 ".concat((0,M.Us)(P))}),Ee();case 8:case"end":return me.stop()}},re)})),children:"\u5F00\u59CB\u4E0A\u4F20"})]})]})}var He=e(25864);function Xe(n){var s=n.folder,a=n.url,h=n.filename,u=n.region,l=d.useState(a||""),E=C()(l,2),g=E[0],F=E[1],P=d.useState(h||""),A=C()(P,2),c=A[0],T=A[1],L=k.Z(!1),Pe=C()(L,2),oe=Pe[0],Ee=Pe[1],De=Ee.setTrue,X=Ee.setFalse,Oe=d.useMemo(function(){return c.trim()?s||/^(\/mnt\/.+)|(^\/tmp\/.+)/.test(c)?"":"\u6587\u4EF6\u53EA\u5141\u8BB8\u4E0A\u4F20\u81F3 /mnt/ \u53CA /tmp/ \u76EE\u5F55":"\u6587\u4EF6\u540D\u4E0D\u80FD\u4E3A\u7A7A"},[c]),re=d.useState({current:0,total:0,status:"pending"}),V=C()(re,2),je=V[0],me=V[1],ae=d.useMemo(function(){return g.indexOf("oss-".concat(u,".aliyuncs.com"))!==-1?g.replace("oss-".concat(u,".aliyuncs.com"),"oss-".concat(u,"-internal.aliyuncs.com")):""},[g]),z=d.useState(!1),_=C()(z,2),b=_[0],w=_[1];d.useEffect(function(){ae&&w(!0)},[ae]);var q=d.useContext(J._);return(0,t.jsxs)(R.Z,{direction:"vertical",style:{width:"100%"},children:[(0,t.jsx)(H.Z,{title:"\u662F\u5426\u5207\u6362\u4E3A\u963F\u91CC\u4E91\u5185\u7F51\u94FE\u63A5\uFF1F",description:(0,t.jsxs)("span",{children:["\u8FD9\u53EF\u4EE5\u907F\u514D\u4EA7\u751F\u6D41\u91CF\u8D39\u7528\uFF0C\u5E76\u4E14\u52A0\u5FEB\u4E0B\u8F7D\u901F\u5EA6\u3002",(0,t.jsx)("br",{}),"\u5185\u7F51\u94FE\u63A5: ",ae]}),trigger:[],open:b,onCancel:function(){return w(!1)},onOpenChange:function(B){return w(B)},onConfirm:function(){F(ae),w(!1)},children:(0,t.jsx)(S.Z,{addonBefore:"\u6587\u4EF6\u5730\u5740",value:g,disabled:oe||!!a,placeholder:"https://xxxx.com/xxx.model",suffix:(0,t.jsx)("span",{children:oe&&(0,t.jsx)($e.Z,{})}),onChange:function(B){var N;return typeof((N=B.target)===null||N===void 0?void 0:N.value)!="undefined"&&F(B.target.value.trim())}})}),(0,t.jsxs)(R.Z.Compact,{style:{width:"100%"},children:[(0,t.jsx)(S.Z,{value:c,disabled:oe||!!h,addonBefore:"\u6587\u4EF6\u540D",prefix:s||void 0,suffix:(0,t.jsx)("span",{children:oe&&(0,t.jsx)($e.Z,{})}),onChange:function(B){var N;return typeof((N=B.target)===null||N===void 0?void 0:N.value)!="undefined"&&T(B.target.value)},placeholder:"\u8BF7\u8F93\u5165\u6587\u4EF6\u540D"}),(0,t.jsx)(y.ZP,{type:"primary",icon:(0,t.jsx)(Se.Z,{}),disabled:oe||!!Oe,onClick:v()(r()().mark(function ee(){var B;return r()().wrap(function(Ze){for(;;)switch(Ze.prev=Ze.next){case 0:De(),B=new ke.tw(g,c),B.run(),q.setCtx(function(Ce){return i()(i()({},Ce),{},{tasks:[].concat(Ae()((Ce==null?void 0:Ce.tasks)||[]),[B])})}),o.Z.success({message:"\u5F00\u59CB\u4E0B\u8F7D ".concat((0,M.Us)(c))}),X();case 6:case"end":return Ze.stop()}},ee)})),children:"\u4E0A\u4F20"})]})]})}function ut(n){var s=ahooks.useCounter(0),a=_slicedToArray(s,2),h=a[0],u=a[1].inc,l=React.useState([h]),E=_slicedToArray(l,2),g=E[0],F=E[1];return _jsx(Space,{direction:"vertical",style:{width:"100%"},children:_jsx(List,{style:{maxHeight:"60vh",overflow:"auto"},dataSource:g,header:_jsxs(Space,{direction:"horizontal",style:{width:"100%",justifyContent:"space-between"},align:"end",children:[_jsx("div",{children:n.extra}),_jsx(Button,{type:"primary",icon:_jsx(PlusOutlined,{}),onClick:function(){u(),F(function(A){return[].concat(_toConsumableArray(A),[h])})}})]}),renderItem:function(A){return _jsx(List.Item,{actions:[_jsx(Button,{icon:_jsx(DeleteOutlined,{}),danger:!0,onClick:function(){F(g.filter(function(T){return T!==A}))}})],children:n.children})}})})}function _e(n){var s=n.folder,a=n.region,h=n.extra,u=d.useState("chunk"),l=C()(u,2),E=l[0],g=l[1];return(0,t.jsx)(ze.Z,{children:(0,t.jsxs)(R.Z,{direction:"vertical",style:{width:"100%"},children:[(0,t.jsx)(Ne.Z,{activeKey:E,items:[{key:"chunk",label:"\u5206\u7247\u4E0A\u4F20",children:(0,t.jsx)(Qe,{folder:s})},{key:"url",label:"\u79BB\u7EBF\u4E0A\u4F20",children:(0,t.jsx)(Xe,{folder:s,region:a})}],onChange:g}),(0,t.jsx)("div",{style:{maxHeight:300,overflowY:"auto",padding:20,overflowX:"hidden"},children:(0,t.jsx)(He.E,{})})]})})}var Ye=["currentPath","region"];function Je(n){var s=n.currentPath,a=n.region,h=Fe()(n,Ye);return(0,t.jsx)(Me.Q,{modalProps:{title:"\u4E0A\u4F20\u6587\u4EF6",style:{minWidth:800}},buttonProps:i()({icon:(0,t.jsx)(Se.Z,{}),children:"\u4E0A\u4F20"},h),children:(0,t.jsx)(_e,{folder:(0,M.Dy)(s,"/"),region:a})})}function qe(n){var s=n.region,a=n.currentPath,h=n.setLoading,u=n.setLoadingFinished,l=n.cache,E=n.run;return(0,t.jsxs)(R.Z,{style:{justifyContent:"space-between",width:"100%"},children:[(0,t.jsx)(R.Z,{children:[{path:"/mnt/auto/sd",label:"sd \u6839\u76EE\u5F55"},{path:"/mnt/auto/sd/models/Stable-diffusion",label:"sd \u57FA\u7840\u6A21\u578B(checkpoint)\u76EE\u5F55"},{path:"/mnt/auto/sd/models/Lora",label:"LoRA \u76EE\u5F55"},{path:"/mnt/auto/sd/models/ControlNet",label:"ControlNet \u76EE\u5F55"},{path:"/mnt/auto/sd/outputs",label:"\u56FE\u7247\u751F\u6210\u76EE\u5F55"}].map(function(g){return(0,t.jsx)(Re.Z,{style:{cursor:"pointer"},onClick:function(){return E(g.path)},children:g.label})})}),(0,t.jsxs)(R.Z,{children:[(0,t.jsx)(Ie,{dir:a,beforeRequest:h,afterRequest:function(F,P){F?o.Z.success({message:"\u521B\u5EFA\u6587\u4EF6\u5939\u6210\u529F"}):o.Z.error({message:"\u521B\u5EFA\u6587\u4EF6\u5939\u5931\u8D25",description:P}),u(),E(a)}}),(0,t.jsx)(We,{disabled:!l,pasteType:(l==null?void 0:l.type)||"copy",src:(l==null?void 0:l.file)||"",dstDir:a,beforeRequest:h,afterRequest:function(F,P){F?o.Z.success({message:"\u7C98\u8D34\u6210\u529F"}):o.Z.error({message:"\u7C98\u8D34\u5931\u8D25",description:P}),u(),E(a)}}),(0,t.jsx)(Je,{currentPath:a,region:s})]})]})}var et=e(77123),tt=["path","beforeRequest","afterRequest"];function nt(n){var s=n.path,a=n.beforeRequest,h=n.afterRequest,u=Fe()(n,tt),l=d.useMemo(function(){return(0,M.XP)(s)},[s]),E=d.useState(""),g=C()(E,2),F=g[0],P=g[1];return d.useEffect(function(){return P((0,M.Us)(s))},[s]),(0,t.jsx)(Me.Q,{modalProps:{title:"\u91CD\u547D\u540D\u6587\u4EF6",okText:"\u91CD\u547D\u540D"},buttonProps:i()({icon:(0,t.jsx)(et.Z,{}),type:"text"},u),beforeRequest:a,afterRequest:h,request:v()(r()().mark(function A(){return r()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return T.next=2,p(s,(0,M.Dy)((0,M.XP)(s),F));case 2:return T.abrupt("return",T.sent);case 3:case"end":return T.stop()}},A)})),children:(0,t.jsx)(S.Z,{addonBefore:(0,M.Dy)(l,"/"),value:F,onChange:function(c){var T;return P((c==null||(T=c.target)===null||T===void 0?void 0:T.value)||"")},style:{width:"100%"}})})}var rt={item:"item___RAKFG"};function at(){var n=d.useState("/mnt/auto"),s=C()(n,2),a=s[0],h=s[1],u=d.useState(a),l=C()(u,2),E=l[0],g=l[1],F=f.Z(function(){var _=v()(r()().mark(function b(w){var q,ee;return r()().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return N.next=2,ce(w);case 2:if(q=N.sent,q.success){N.next=6;break}return o.Z.error({message:"\u76EE\u5F55\u4E0D\u5B58\u5728",description:"\u76EE\u5F55 ".concat(w," \u4E0D\u5B58\u5728\uFF0C\u8FD9\u53EF\u80FD\u662F\u56E0\u4E3A\u60A8\u9996\u6B21\u4F7F\u7528\u8FD8\u672A\u521B\u5EFA\u6539\u76EE\u5F55\u3002\u8BE6\u7EC6\u4FE1\u606F\uFF1A").concat(q.errMsg)}),N.abrupt("return",[]);case 6:return ee=q.files||[],g(w),h(w),N.abrupt("return",ee.sort(function(Ze,Ce){return Ze.is_dir&&!Ce.is_dir?-1:!Ze.is_dir&&Ce.is_dir?1:Ze.name.localeCompare(Ce.name)}));case 10:case"end":return N.stop()}},b)}));return function(b){return _.apply(this,arguments)}}(),{retryCount:3,defaultParams:[a],manual:!0}),P=F.data,A=F.loading,c=F.run,T=k.Z(!1),L=C()(T,2),Pe=L[0],oe=L[1],Ee=oe.setTrue,De=oe.setFalse,X=A||Pe,Oe=d.useState(void 0),re=C()(Oe,2),V=re[0],je=re[1],me=d.useCallback(function(){var _=document.getElementById("scrollableDiv");_&&(_.style.height="".concat(window.innerHeight-_.offsetTop-50,"px"))},[]);d.useEffect(function(){return me()},[]),x.Z("resize",me);var ae=d.useContext(J._),z=ae.info;return d.useEffect(function(){(z==null?void 0:z.withNas)===!1?o.Z.warning({message:"\u672A\u6302\u8F7D NAS",description:"\u8BF7\u5728\u8BBE\u7F6E\u4E2D\u6302\u8F7D NAS \u540E\u4F7F\u7528"}):(z==null?void 0:z.withNas)===!0&&c(a)},[z==null?void 0:z.withNas]),(0,t.jsx)(ye.r,{disabled:!(z!=null&&z.withNas),children:(0,t.jsxs)(R.Z,{direction:"vertical",style:{width:"100%"},styles:{item:{width:"100%"}},children:[(0,t.jsxs)(R.Z.Compact,{style:{width:"100%"},children:[(0,t.jsx)(S.Z,{value:a,onChange:function(b){var w;return h((b==null||(w=b.target)===null||w===void 0?void 0:w.value)||"")},onKeyDown:function(b){b.key==="Enter"&&c(a)}}),(0,t.jsx)(y.ZP,{type:"primary",icon:(0,t.jsx)(he.Z,{}),loading:X,onClick:function(){return c(a)}}),(0,t.jsx)(y.ZP,{icon:(0,t.jsx)(xe.Z,{}),loading:X,onClick:function(){return c(E.split("/").reverse().slice(1).reverse().join("/"))}})]}),(0,t.jsx)(qe,{region:(z==null?void 0:z.region)||"public",currentPath:E,setLoading:Ee,setLoadingFinished:De,cache:V,run:c}),(0,t.jsx)("div",{id:"scrollableDiv",style:{height:800,overflow:"auto",padding:"0 16px",border:"1px solid rgba(140, 140, 140, 0.35)",background:"white"},children:(0,t.jsx)(I.Z,{dataSource:P,loading:X,size:"small",renderItem:function(b){return(0,t.jsx)(I.Z.Item,{children:(0,t.jsxs)(ge.Z,{style:{width:"100%"},children:[(0,t.jsx)(Z.Z,{span:18,children:(0,t.jsx)("div",i()(i()({},b.is_dir&&{className:rt.item,onClick:function(){c("".concat(E.replace(/([\/ ]*)$/g,""),"/").concat(b.name))}}),{},{children:(0,t.jsxs)(ie.Z.Text,{ellipsis:{tooltip:b.name},style:{width:"70%"},children:[b.is_dir?(0,t.jsx)(Te.Z,{style:{marginRight:"1em",color:"#869aa4"}}):(0,t.jsx)(ve.Z,{style:{marginRight:"1em",color:"#869aa4"}}),b.name]})}))}),(0,t.jsx)(Z.Z,{span:6,children:(0,t.jsxs)(R.Z,{align:"center",style:{justifyContent:"end",width:"100%"},children:[!b.is_dir&&(0,ne.t)(b.size),(0,t.jsx)(y.ZP,{icon:(0,t.jsx)(O.Z,{}),type:"text",onClick:function(){je({file:b.path,type:"cut"})}}),(0,t.jsx)(y.ZP,{icon:(0,t.jsx)(m.Z,{}),type:"text",onClick:function(){je({file:b.path,type:"copy"})}}),(0,t.jsx)(nt,{path:b.path,beforeRequest:Ee,afterRequest:function(q,ee){q?o.Z.success({message:"\u91CD\u547D\u540D\u6210\u529F"}):o.Z.error({message:"\u91CD\u547D\u540D\u5931\u8D25",description:ee}),De(),c(E)}}),(0,t.jsx)(H.Z,{title:"\u786E\u8BA4\u5220\u9664\u6587\u4EF6?",description:(0,t.jsxs)(ie.Z.Text,{children:["\u6587\u4EF6",(0,t.jsx)(ie.Z.Text,{code:!0,style:{margin:"0 0.5em"},children:b.name}),"\u5220\u9664\u540E\u4E0D\u53EF\u6062\u590D"]}),onConfirm:v()(r()().mark(function w(){var q;return r()().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return Ee(),B.prev=1,B.next=4,D(b.path);case 4:q=B.sent,q.success||o.Z.error({message:"\u5220\u9664\u6587\u4EF6\u9519\u8BEF",description:q.errMsg}),B.next=11;break;case 8:B.prev=8,B.t0=B.catch(1),o.Z.error({message:"\u672A\u77E5\u9519\u8BEF",description:"".concat(B.t0)});case 11:De(),c(E);case 13:case"end":return B.stop()}},w,null,[[1,8]])})),children:(0,t.jsx)(y.ZP,{icon:(0,t.jsx)($.Z,{}),danger:!0,type:"text"})})]})})]})})}})})]})})}function st(){return(0,t.jsx)("div",{style:{padding:20,height:"100%"},children:(0,t.jsx)(at,{})})}},70507:function(pe,W,e){var K=e(82188),i=e(6154);i.Z.interceptors.response.use(function(j){return j},function(j){return j.response&&(j.response.status===401&&K.m8.push("/login"),j.response.status!==200)?j.response:Promise.reject(j)}),W.Z=i.Z},43331:function(pe,W,e){e.d(W,{Vz:function(){return Te},tw:function(){return ve}});var K=e(15009),i=e.n(K),j=e(99289),r=e.n(j),U=e(25098),v=e.n(U),le=e(31996),C=e.n(le),se=e(26037),ce=e.n(se),ue=e(12444),D=e.n(ue),de=e(72004),Q=e.n(de),te=e(9783),p=e.n(te),Y=function(){function O(m){D()(this,O),p()(this,"maxRunning",void 0),p()(this,"running",void 0),this.maxRunning=m,this.running=0}return Q()(O,[{key:"getToken",value:function(){var m=r()(i()().mark(function f(){var k=this;return i()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!(this.running>=this.maxRunning)){o.next=3;break}return o.next=3,new Promise(function(R){var S=setInterval(function(){k.running<k.maxRunning&&(clearInterval(S),R(void 0))},100)});case 3:this.running++;case 4:case"end":return o.stop()}},f,this)}));function $(){return m.apply(this,arguments)}return $}()},{key:"releaseToken",value:function(){this.running--}}]),O}(),fe=e(70507);function G(O,m,$){return ne.apply(this,arguments)}function ne(){return ne=r()(i()().mark(function O(m,$,f){var k;return i()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,fe.Z.post("/api/upload/chunk?filename=".concat(encodeURIComponent(m),"&start=").concat(encodeURIComponent($)),f);case 2:return k=o.sent,o.abrupt("return",k.data);case 4:case"end":return o.stop()}},O)})),ne.apply(this,arguments)}function J(O,m,$,f){return he.apply(this,arguments)}function he(){return he=r()(i()().mark(function O(m,$,f,k){return i()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,new Promise(function(R,S){var y=new WebSocket("".concat(location.protocol.replace("http","ws"),"//").concat(location.hostname,":").concat(location.port,"/api/upload/url?filename=").concat(encodeURIComponent(m),"&url=").concat(encodeURIComponent($)));y.onerror=S,y.onopen=function(){y.send("client send hi")};var I=!1,ge="";y.onmessage=function(ie){try{var H=JSON.parse(ie.data),d=H.current,ye=H.total,Re=H.success,Be=H.errMsg;Re===!0?I=!0:Re===!1?(I=!1,ge=Be):f(d,ye)}catch(Fe){console.error(Fe),console.log(ie)}},y.onclose=function(){R(void 0),y.close(),k(I,ge)}});case 2:return o.abrupt("return",{success:!0});case 3:case"end":return o.stop()}},O)})),he.apply(this,arguments)}var xe=function(){function O(){D()(this,O),p()(this,"key",""),p()(this,"type","unknown"),p()(this,"target",""),p()(this,"current",0),p()(this,"total",0),p()(this,"finished",!1),p()(this,"error",""),this.key=Math.random().toString(36).substr(2,8)}return Q()(O,[{key:"getKey",value:function(){return this.key}},{key:"getCurrent",value:function(){return this.current}},{key:"getTotal",value:function(){return this.total}},{key:"getProgress",value:function(){return this.total===0?0:this.current/this.total}},{key:"getFileName",value:function(){return this.target}},{key:"isFinished",value:function(){return this.finished}},{key:"getError",value:function(){return this.error}},{key:"run",value:function(){}}]),O}(),Te=function(O){C()($,O);var m=ce()($);function $(f,k){var x;return D()(this,$),x=m.call(this),p()(v()(x),"type","chunk"),p()(v()(x),"file",void 0),x.file=f,x.target=k,x}return Q()($,[{key:"uploadWithRetry",value:function(){var f=r()(i()().mark(function x(o,R,S){var y,I;return i()().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:y=5,I="";case 2:if(!(y>0)){Z.next=16;break}return Z.prev=3,Z.next=6,G(o,R,S);case 6:return Z.abrupt("return",Z.sent);case 9:return Z.prev=9,Z.t0=Z.catch(3),y--,I=Z.t0.toString(),Z.abrupt("continue",2);case 14:Z.next=2;break;case 16:throw I;case 17:case"end":return Z.stop()}},x,null,[[3,9]])}));function k(x,o,R){return f.apply(this,arguments)}return k}()},{key:"run",value:function(){var f=r()(i()().mark(function x(){var o=this,R,S,y,I,ge,Z,ie,H,d,ye,Re,Be;return i()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:R=this.file,S=this.target,this.total=R.size,y=new Y(10),I=1048576,ge=Math.ceil(this.file.size/I),Z=[],ie=0,H="",d=0;case 10:if(!(d<ge)){M.next=22;break}return ye=d*I,Re=Math.min(ye+I,R.size),Be=R.slice(ye,Re),M.next=16,y.getToken();case 16:if(Z.push(this.uploadWithRetry(S,ye,Be).catch(function(be){H="".concat(be)}).then(function(){ie++,o.current=ie*I,y.releaseToken()})),!H){M.next=19;break}return M.abrupt("break",22);case 19:d++,M.next=10;break;case 22:return M.next=24,Promise.all(Z);case 24:H?this.error=H:this.finished=!0;case 25:case"end":return M.stop()}},x,this)}));function k(){return f.apply(this,arguments)}return k}()}]),$}(xe),ve=function(O){C()($,O);var m=ce()($);function $(f,k){var x;return D()(this,$),x=m.call(this),p()(v()(x),"type","url"),p()(v()(x),"url",void 0),x.url=f,x.target=k,x}return Q()($,[{key:"run",value:function(){var f=r()(i()().mark(function x(){var o=this;return i()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.next=2,J(this.target,this.url,function(y,I){o.current=y,o.total=I},function(y,I){o.finished=y,o.error=I||""});case 2:case"end":return S.stop()}},x,this)}));function k(){return f.apply(this,arguments)}return k}()}]),$}(xe)},92380:function(pe,W,e){e.d(W,{t:function(){return K}});function K(i){for(var j=["B","KB","MB","GB","TB"],r=0;i>1024;)i/=1024,r++;return"".concat(i.toFixed(2)," ").concat(j[r])}},85504:function(pe,W,e){e.d(W,{_:function(){return j},i:function(){return i}});var K=e(62435),i={info:void 0,tasks:[],setCtx:function(){}},j=K.createContext(i)},53371:function(pe,W,e){e.d(W,{Dy:function(){return j},Us:function(){return i},XP:function(){return K}});function K(r){var U=r.lastIndexOf("/");return U===-1?"/":r.substring(0,U)}function i(r){var U=r.lastIndexOf("/");return U===-1?r:r.substring(U+1)}function j(){for(var r=arguments.length,U=new Array(r),v=0;v<r;v++)U[v]=arguments[v];return U.join("/").replace(/\/+/g,"/")}}}]);
