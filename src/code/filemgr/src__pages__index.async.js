"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[858],{67090:function(Un,pe,s){s.r(pe),s.d(pe,{default:function(){return Ln}});var Se=s(97857),S=s.n(Se),we=s(15009),h=s.n(we),be=s(99289),E=s.n(be),Pe=s(5574),R=s.n(Pe),ke=s(82188),_=s(6154);_.Z.interceptors.response.use(function(n){return n},function(n){return n.response&&(n.response.status===401&&ke.m8.push("/login"),n.response.status!==200)?n.response:Promise.reject(n)});var G=_.Z;function De(n){return ee.apply(this,arguments)}function ee(){return ee=E()(h()().mark(function n(r){var t;return h()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,G.get("/api/file/list?path=".concat(r));case 2:return t=a.sent,a.abrupt("return",t.data);case 4:case"end":return a.stop()}},n)})),ee.apply(this,arguments)}function me(n){return ne.apply(this,arguments)}function ne(){return ne=E()(h()().mark(function n(r){var t;return h()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,G.delete("/api/file?path=".concat(r));case 2:return t=a.sent,a.abrupt("return",t.data);case 4:case"end":return a.stop()}},n)})),ne.apply(this,arguments)}function zn(n){return re.apply(this,arguments)}function re(){return re=_asyncToGenerator(_regeneratorRuntime().mark(function n(r){var t;return _regeneratorRuntime().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,axios.put("/api/folder",null,{params:{path:r}});case 2:return t=a.sent,a.abrupt("return",t.data);case 4:case"end":return a.stop()}},n)})),re.apply(this,arguments)}function ge(n,r){return te.apply(this,arguments)}function te(){return te=E()(h()().mark(function n(r,t){var u;return h()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,G.post("/api/file/move",null,{params:{src:r,dst:t}});case 2:return u=i.sent,i.abrupt("return",u.data);case 4:case"end":return i.stop()}},n)})),te.apply(this,arguments)}function Ae(n,r){return ae.apply(this,arguments)}function ae(){return ae=E()(h()().mark(function n(r,t){var u;return h()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,G.post("/api/copy/move",null,{params:{src:r,dst:t}});case 2:return u=i.sent,i.abrupt("return",u.data);case 4:case"end":return i.stop()}},n)})),ae.apply(this,arguments)}function Te(){return ue.apply(this,arguments)}function ue(){return ue=E()(h()().mark(function n(){var r;return h()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,G.get("/api/info");case 2:return r=u.sent,u.abrupt("return",r.data);case 4:case"end":return u.stop()}},n)})),ue.apply(this,arguments)}function Y(n){for(var r=["B","KB","MB","GB","TB"],t=0;n>1024;)n/=1024,t++;return"".concat(n.toFixed(2)," ").concat(r[t])}var Ie=s(9957),Oe=s(71965),Me=s(93613),Le=s(26911),Ue=s(19478),ze=s(57132),Fe=s(48689),se=s(66834),ie=s(22821),Ne=s(53606),T=s(54689),A=s(42075),W=s(79531),O=s(71577),U=s(46205),je=s(86738),le=s(26196),g=s(62435),We=s(13769),J=s.n(We);function Ce(n){var r=n.lastIndexOf("/");return r===-1?"/":n.substring(0,r)}function ye(n){var r=n.lastIndexOf("/");return r===-1?n:n.substring(r+1)}function z(){for(var n=arguments.length,r=new Array(n),t=0;t<n;t++)r[t]=arguments[t];return r.join("/").replace(/\/+/g,"/")}var Ge=s(83266),Ke=s(36147),e=s(86074);function V(n){var r=n.modalProps,t=n.buttonProps,u=n.children,a=n.beforeRequest,i=n.afterRequest,l=n.request,o=g.useState(!1),c=R()(o,2),v=c[0],d=c[1];return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Ke.Z,S()(S()({open:v,onCancel:function(){return d(!1)},maskClosable:!0,destroyOnClose:!0,onOk:E()(h()().mark(function f(){var p;return h()().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(l){j.next=2;break}return j.abrupt("return");case 2:return a&&a(),j.prev=3,j.next=6,l();case 6:p=j.sent,p.success?(i&&i(!0),d(!1)):i&&i(!1,"".concat(p.errMsg)),j.next=13;break;case 10:j.prev=10,j.t0=j.catch(3),i&&i(!1,"".concat(j.t0));case 13:case"end":return j.stop()}},f,null,[[3,10]])})),okButtonProps:l?{}:{style:{display:"none"}}},r),{},{children:v&&u})),(0,e.jsx)(O.ZP,S()({onClick:function(){return d(!0)}},t))]})}var Ve=["dir","beforeRequest","afterRequest"];function He(n){var r=n.dir,t=n.beforeRequest,u=n.afterRequest,a=J()(n,Ve),i=g.useState("newfolder_".concat(Date.now()%1e3)),l=R()(i,2),o=l[0],c=l[1];return(0,e.jsx)(V,{modalProps:{title:"\u65B0\u5EFA\u6587\u4EF6\u5939",okText:"\u521B\u5EFA"},buttonProps:S()({icon:(0,e.jsx)(Ge.Z,{}),title:"\u65B0\u5EFA\u6587\u4EF6\u5939"},a),beforeRequest:t,afterRequest:u,request:E()(h()().mark(function v(){return h()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,me(z(r,o));case 2:return f.abrupt("return",f.sent);case 3:case"end":return f.stop()}},v)})),children:(0,e.jsx)(W.Z,{addonBefore:z(r,"/"),value:o,onChange:function(d){var f;return c((d==null||(f=d.target)===null||f===void 0?void 0:f.value)||"")},style:{width:"100%"}})})}function Qe(n,r,t,u){return oe.apply(this,arguments)}function oe(){return oe=E()(h()().mark(function n(r,t,u,a){return h()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,new Promise(function(o,c){var v=new WebSocket("".concat(location.protocol.replace("http","ws"),"//").concat(location.hostname,":").concat(location.port,"/api/upload/url?filename=").concat(encodeURIComponent(r),"&url=").concat(encodeURIComponent(t)));v.onerror=c,v.onopen=function(){v.send("client send hi")};var d=!1;v.onmessage=function(p){try{var F=JSON.parse(p.data),j=F.current,I=F.total,C=F.success;C===!0?d=!0:C===!1?d=!1:u(j,I)}catch(B){console.error(B),console.log(p)}},v.onclose=function(){o(void 0),v.close(),a(d)}});case 2:return l.abrupt("return",{success:!0});case 3:case"end":return l.stop()}},n)})),oe.apply(this,arguments)}var q=s(50888),ce=s(88484),xe=s(2453),Je=s(69814);function Ze(n){var r=n.folder,t=n.url,u=n.filename,a=n.region,i=g.useState(t||""),l=R()(i,2),o=l[0],c=l[1],v=g.useState(u||""),d=R()(v,2),f=d[0],p=d[1],F=ie.Z(!1),j=R()(F,2),I=j[0],C=j[1],B=C.setTrue,$=C.setFalse,L=g.useMemo(function(){return f.trim()?r||/^(\/mnt\/.+)|(^\/tmp\/.+)/.test(f)?"":"\u6587\u4EF6\u53EA\u5141\u8BB8\u4E0A\u4F20\u81F3 /mnt/ \u53CA /tmp/ \u76EE\u5F55":"\u6587\u4EF6\u540D\u4E0D\u80FD\u4E3A\u7A7A"},[f]),w=g.useState({current:0,total:0,status:"pending"}),N=R()(w,2),P=N[0],H=N[1],Q=g.useMemo(function(){return o.indexOf("oss-".concat(a,".aliyuncs.com"))!==-1?o.replace("oss-".concat(a,".aliyuncs.com"),"oss-".concat(a,"-internal.aliyuncs.com")):""},[o]),x=g.useState(!1),D=R()(x,2),Z=D[0],y=D[1];return g.useEffect(function(){Q&&y(!0)},[Q]),(0,e.jsxs)("div",{className:"flex-tb",style:{width:"100%"},children:[(0,e.jsx)(je.Z,{title:"\u662F\u5426\u5207\u6362\u4E3A\u963F\u91CC\u4E91\u5185\u7F51\u94FE\u63A5\uFF1F",description:(0,e.jsxs)("span",{children:["\u8FD9\u53EF\u4EE5\u907F\u514D\u4EA7\u751F\u6D41\u91CF\u8D39\u7528\uFF0C\u5E76\u4E14\u52A0\u5FEB\u4E0B\u8F7D\u901F\u5EA6\u3002",(0,e.jsx)("br",{}),"\u5185\u7F51\u94FE\u63A5: ",Q]}),trigger:[],open:Z,onCancel:function(){return y(!1)},onOpenChange:function(k){return y(k)},onConfirm:function(){c(Q),y(!1)},children:(0,e.jsx)(W.Z,{addonBefore:"\u6587\u4EF6\u5730\u5740",value:o,disabled:I||!!t,placeholder:"https://xxxx.com/xxx.model",suffix:(0,e.jsx)("span",{children:I&&(0,e.jsx)(q.Z,{})}),onChange:function(k){var m;return typeof((m=k.target)===null||m===void 0?void 0:m.value)!="undefined"&&c(k.target.value.trim())}})}),(0,e.jsxs)(A.Z.Compact,{children:[(0,e.jsx)(W.Z,{value:f,disabled:I||!!u,addonBefore:"\u6587\u4EF6\u540D",prefix:r||void 0,suffix:(0,e.jsx)("span",{children:I&&(0,e.jsx)(q.Z,{})}),onChange:function(k){var m;return typeof((m=k.target)===null||m===void 0?void 0:m.value)!="undefined"&&p(k.target.value)},status:L&&"error"}),(0,e.jsx)(O.ZP,{type:"primary",icon:(0,e.jsx)(ce.Z,{}),disabled:I||!!L,onClick:E()(h()().mark(function b(){return h()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return B(),H({current:0,total:0,status:"pending"}),m.prev=2,m.next=5,Qe(r?z(r,f):f,o,function(M,K){H(function(X){return S()(S()({},X),{},{current:M,total:K})})},function(M){H(function(K){return S()(S()({},K),{},{status:M?"success":"failed"})})});case 5:m.next=11;break;case 7:m.prev=7,m.t0=m.catch(2),console.error(m.t0),xe.ZP.error("".concat(m.t0));case 11:$();case 12:case"end":return m.stop()}},b,null,[[2,7]])})),children:"\u4E0A\u4F20"})]}),(0,e.jsx)(Je.Z,{className:"progress-bar",percent:P.status==="success"?100:P.total===0?0:P.total>0?P.current/P.total*100:1,format:function(k,m){return"".concat(Math.round((k||0)*100)/100,"%  ").concat(Y(P.current),"/").concat(Y(P.total))},status:P.status==="success"?"success":P.status==="failed"?"exception":"active"}),L&&(0,e.jsx)("span",{style:{color:"red"},children:L})]})}var Xe=s(41156),Ye=s(99138),Ee=s(51904),qe=s(98293),_e=s(43384),en=["region"],Re="http://server-ai-backend-agwwspzdwb.cn-hangzhou.devsapp.net";function nn(n){var r=n.model,t=n.region;return(0,e.jsx)(V,{modalProps:{title:"\u5B89\u88C5\u6A21\u578B ".concat(r.name),width:800},buttonProps:{children:"\u5B89\u88C5",type:"primary",size:"small"},children:(0,e.jsx)(U.Z,{style:{width:"100%"},dataSource:r.files,renderItem:function(a){return(0,e.jsx)(U.Z.Item,{children:(0,e.jsx)(Ze,{url:a.ossname?"".concat(Re,"/oss_models/url/").concat(t,"/").concat(a.ossname):a.url,filename:a.filename})})}})})}function rn(n){var r=n.region,t=J()(n,en),u=se.Z(E()(h()().mark(function o(){var c;return h()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,_.Z.get("".concat(Re,"/oss_models/list"));case 2:return c=d.sent,d.abrupt("return",c.data);case 4:case"end":return d.stop()}},o)})),{retryCount:3}),a=u.data,i=u.loading,l=u.run;return(0,e.jsx)(V,{modalProps:{title:"\u6A21\u578B\u5E93",style:{minWidth:800}},buttonProps:S()({icon:(0,e.jsx)(Xe.Z,{}),children:"OSS \u6A21\u578B\u5E93"},t),children:(0,e.jsxs)(A.Z,{direction:"vertical",style:{width:"100%",maxHeight:"70vh",overflow:"auto"},children:[(0,e.jsx)(Ye.Z,{message:"\u6A21\u578B\u5E93\u4F7F\u7528\u8BF4\u660E",description:(0,e.jsxs)(le.Z.Paragraph,{children:["\u5982\u4E0A\u5C55\u793A\u6A21\u578B/\u6570\u636E\u96C6/\u6587\u4EF6\u5747\u6765\u6E90\u4E8E\u7B2C\u4E09\u65B9\uFF0C\u963F\u91CC\u4E91\u4E0D\u4FDD\u8BC1\u5408\u89C4\u6027\uFF0C\u8BF7\u60A8\u5728\u4F7F\u7528\u524D\u614E\u91CD\u8003\u8651\u3002\u6B64\u5916\uFF0C\u60A8\u8FD8\u5E94\u4E25\u683C\u9075\u5B88\u6CD5\u5F8B\u6CD5\u89C4\u3001\u7B2C\u4E09\u65B9\u8981\u6C42\u7B49\uFF0C\u7279\u522B\u662F\u4E0D\u5F97\u5229\u7528\u672C\u670D\u52A1\u4ECE\u4E8B\u8FDD\u6CD5\u8FDD\u89C4\u884C\u4E3A\uFF08\u5982\u4E0A\u4F20/\u8F93\u5165/\u751F\u6210/\u4E0B\u8F7D/\u4F7F\u7528\u8FDD\u6CD5\u6216\u4E0D\u826F\u4FE1\u606F\u7B49\uFF09\u3002\u5177\u4F53\u8BE6\u89C1"," ",(0,e.jsx)("a",{href:"http://terms.aliyun.com/legal-agreement/terms/suit_bu1_ali_cloud/suit_bu1_ali_cloud201912232313_55403.html",target:"_blank",rel:"noreferrer",children:"\u300A\u5BF9\u8C61\u5B58\u50A8\uFF08OSS\uFF09\u5BF9\u8C61\u5B58\u50A8\uFF08OSS\uFF09\u670D\u52A1\u6761\u6B3E\u300B"})," ","\u53CA\u9875\u9762\u5C55\u793A\u4FE1\u606F\u7B49\u3002\u5982\u60A8\u53D1\u73B0\u4EFB\u4F55\u6A21\u578B/\u6570\u636E\u96C6/\u6587\u4EF6\u7B49\u6709\u95EE\u9898\uFF0C\u8BF7\u53CA\u65F6\u8054\u7CFB\u6211\u4EEC\u5904\u7406\u3002",(0,e.jsx)("br",{}),(0,e.jsx)("br",{}),(0,e.jsx)("a",{href:"https://www.yuque.com/publicmodel/kaq1i2/dds7alalpgv6fsbv",target:"_blank",rel:"noreferrer",children:"\u76F8\u5173\u6A21\u578B\u4ECB\u7ECD"})]})}),(0,e.jsx)(Ee.Z,{children:r}),(0,e.jsx)(U.Z,{loading:i,dataSource:a,extra:(0,e.jsx)(O.ZP,{size:"small",icon:(0,e.jsx)(q.Z,{}),loading:i,onClick:l}),renderItem:function(c){return(0,e.jsxs)(U.Z.Item,{actions:[(0,e.jsx)(nn,{model:c,region:r})],children:[(0,e.jsx)(U.Z.Item.Meta,{avatar:c.image&&(0,e.jsx)(qe.C,{size:"large",shape:"square",icon:(0,e.jsx)(_e.Z,{src:c.image})}),title:c.name,description:Y(c.size)}),c.tags.map(function(v){return(0,e.jsx)(Ee.Z,{children:v},v)})]})}})]})})}var tn=s(56334),an=["pasteType","src","dstDir","beforeRequest","afterRequest"];function un(n){var r=n.pasteType,t=n.src,u=n.dstDir,a=n.beforeRequest,i=n.afterRequest,l=J()(n,an),o=g.useState(""),c=R()(o,2),v=c[0],d=c[1];return g.useEffect(function(){return d(ye(t))},[t]),(0,e.jsx)(V,{modalProps:{title:"".concat(r==="copy"?"\u590D\u5236":r==="cut"?"\u79FB\u52A8":"\u7C98\u8D34","\u6587\u4EF6"),okText:"\u7C98\u8D34"},buttonProps:S()({icon:(0,e.jsx)(tn.Z,{})},l),beforeRequest:a,afterRequest:i,request:E()(h()().mark(function f(){return h()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return F.next=2,(r==="cut"?ge:Ae)(t,z(u,v));case 2:return F.abrupt("return",F.sent);case 3:case"end":return F.stop()}},f)})),children:(0,e.jsxs)(A.Z,{direction:"vertical",style:{width:"100%"},children:[(0,e.jsx)(W.Z,{value:t,disabled:!0,style:{width:"100%"},addonBefore:"\u539F\u59CB\u6587\u4EF6"}),(0,e.jsx)(W.Z,{addonBefore:"\u76EE\u6807\u6587\u4EF6",prefix:z(u,"/"),value:v,onChange:function(p){var F;return d((p==null||(F=p.target)===null||F===void 0?void 0:F.value)||"")},style:{width:"100%"}})]})})}var sn=s(19632),ln=s.n(sn),on=s(24969),cn=s(25999),dn=s(85813),fn=s(25904),hn=s(64082),vn=s(92782);function pn(n,r,t){return de.apply(this,arguments)}function de(){return de=E()(h()().mark(function n(r,t,u){var a;return h()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,G.post("/api/upload/chunk?filename=".concat(encodeURIComponent(r),"&start=").concat(encodeURIComponent(t)),u);case 2:return a=l.sent,l.abrupt("return",a.data);case 4:case"end":return l.stop()}},n)})),de.apply(this,arguments)}var mn=s(12444),gn=s.n(mn),Fn=s(72004),jn=s.n(Fn),Cn=s(9783),Be=s.n(Cn),yn=function(){function n(r){gn()(this,n),Be()(this,"maxRunning",void 0),Be()(this,"running",void 0),this.maxRunning=r,this.running=0}return jn()(n,[{key:"getToken",value:function(){var r=E()(h()().mark(function u(){var a=this;return h()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(!(this.running>=this.maxRunning)){l.next=3;break}return l.next=3,new Promise(function(o){var c=setInterval(function(){a.running<a.maxRunning&&(clearInterval(c),o(void 0))},100)});case 3:this.running++;case 4:case"end":return l.stop()}},u,this)}));function t(){return r.apply(this,arguments)}return t}()},{key:"releaseToken",value:function(){this.running--}}]),n}();function xn(n,r,t){return fe.apply(this,arguments)}function fe(){return fe=E()(h()().mark(function n(r,t,u){var a,i;return h()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:a=5,i="";case 2:if(!(a>0)){o.next=16;break}return o.prev=3,o.next=6,pn(r,t,u);case 6:return o.abrupt("return",o.sent);case 9:return o.prev=9,o.t0=o.catch(3),a--,i=o.t0.toString(),o.abrupt("continue",2);case 14:o.next=2;break;case 16:throw i;case 17:case"end":return o.stop()}},n,null,[[3,9]])})),fe.apply(this,arguments)}function Zn(n,r,t,u){return he.apply(this,arguments)}function he(){return he=E()(h()().mark(function n(r,t,u,a){var i,l,o,c,v,d,f,p,F,j;return h()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:u(0),i=new yn(10),l=1024*1024,o=Math.ceil(t.size/l),c=[],v=0,d="",f=0;case 8:if(!(f<o)){C.next=20;break}return p=f*l,F=Math.min(p+l,t.size),j=t.slice(p,F),C.next=14,i.getToken();case 14:if(c.push(xn(r,p,j).catch(function(B){d="".concat(B)}).then(function(){v++,u(v*l/t.size),i.releaseToken()})),!d){C.next=17;break}return C.abrupt("break",20);case 17:f++,C.next=8;break;case 20:return C.next=22,Promise.all(c);case 22:return d&&a(d),C.abrupt("return");case 24:case"end":return C.stop()}},n)})),he.apply(this,arguments)}function En(n){var r=n.folder,t=g.useState([]),u=R()(t,2),a=u[0],i=u[1],l=g.useState(""),o=R()(l,2),c=o[0],v=o[1],d=ie.Z(!1),f=R()(d,2),p=f[0],F=f[1],j=F.setTrue,I=F.setFalse,C=g.useMemo(function(){return c.trim()?r||/^(\/mnt\/.+)|(^\/tmp\/.+)/.test(c)?"":"\u6587\u4EF6\u53EA\u5141\u8BB8\u4E0A\u4F20\u81F3 /mnt/ \u53CA /tmp/ \u76EE\u5F55":"\u6587\u4EF6\u540D\u4E0D\u80FD\u4E3A\u7A7A"},[c]);return g.useEffect(function(){var B,$=a==null||(B=a[0])===null||B===void 0?void 0:B.originFileObj;$&&v($.name)},[a]),(0,e.jsxs)("div",{className:"flex-tb",style:{width:"100%"},children:[(0,e.jsxs)(vn.Z.Dragger,{disabled:p,maxCount:1,customRequest:function(){},fileList:a,onChange:function($){return i($.fileList)},onRemove:function(){return!1},showUploadList:{showRemoveIcon:!1,showPreviewIcon:!1},progress:{strokeColor:{"0%":"#108ee9","100%":"#87d068"},strokeWidth:3,format:function($){return $?"".concat(parseFloat($.toFixed(2)),"%"):""}},children:[(0,e.jsx)(hn.Z,{style:{fontSize:18,marginRight:"0.5em"}}),"\u62D6\u62FD\u6216\u9009\u62E9\u6587\u4EF6"]}),(0,e.jsxs)(A.Z.Compact,{children:[(0,e.jsx)(W.Z,{value:c,disabled:p,addonBefore:"\u6587\u4EF6\u540D",prefix:r||void 0,suffix:(0,e.jsx)("span",{children:p&&(0,e.jsx)(q.Z,{})}),onChange:function($){var L;return typeof((L=$.target)===null||L===void 0?void 0:L.value)!="undefined"&&v($.target.value)},status:C&&"error"}),(0,e.jsx)(O.ZP,{type:"primary",icon:(0,e.jsx)(ce.Z,{}),disabled:p||!!C,onClick:E()(h()().mark(function B(){var $;return h()().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if($=a[0].originFileObj,$){w.next=3;break}return w.abrupt("return");case 3:return j(),w.prev=4,w.next=7,Zn(r?z(r,c):c,$,function(N){console.log(N),i(function(P){return[S()(S()({},P[0]),{},{percent:N*100,status:N===1?"done":"uploading"})]})},function(N){i(function(P){return[S()(S()({},P[0]),{},{status:"error"})]})});case 7:w.next=13;break;case 9:w.prev=9,w.t0=w.catch(4),console.error(w.t0),xe.ZP.error("".concat(w.t0));case 13:I();case 14:case"end":return w.stop()}},B,null,[[4,9]])})),children:"\u4E0A\u4F20"})]}),C&&(0,e.jsx)("span",{style:{color:"red"},children:C})]})}function $e(n){var r=cn.Z(0),t=R()(r,2),u=t[0],a=t[1].inc,i=g.useState([u]),l=R()(i,2),o=l[0],c=l[1];return(0,e.jsx)(A.Z,{direction:"vertical",style:{width:"100%"},children:(0,e.jsx)(U.Z,{style:{maxHeight:"60vh",overflow:"auto"},dataSource:o,header:(0,e.jsxs)(A.Z,{direction:"horizontal",style:{width:"100%",justifyContent:"space-between"},align:"end",children:[(0,e.jsx)("div",{children:n.extra}),(0,e.jsx)(O.ZP,{type:"primary",icon:(0,e.jsx)(on.Z,{}),onClick:function(){a(),c(function(d){return[].concat(ln()(d),[u])})}})]}),renderItem:function(d){return(0,e.jsx)(U.Z.Item,{actions:[(0,e.jsx)(O.ZP,{icon:(0,e.jsx)(Fe.Z,{}),danger:!0,onClick:function(){c(o.filter(function(p){return p!==d}))}})],children:n.children})}})})}function Rn(n){var r=n.folder,t=n.region,u=n.extra,a=g.useState("chunk"),i=R()(a,2),l=i[0],o=i[1];return(0,e.jsx)(dn.Z,{children:(0,e.jsx)(fn.Z,{activeKey:l,items:[{key:"chunk",label:"\u5206\u7247\u4E0A\u4F20",children:(0,e.jsx)($e,{extra:u,children:(0,e.jsx)(En,{folder:r})})},{key:"url",label:"\u79BB\u7EBF\u4E0A\u4F20",children:(0,e.jsx)($e,{extra:u,children:(0,e.jsx)(Ze,{folder:r,region:t})})}],onChange:o})})}var Bn=["currentPath","region"];function $n(n){var r=n.currentPath,t=n.region,u=J()(n,Bn);return(0,e.jsx)(V,{modalProps:{title:"\u4E0A\u4F20\u6587\u4EF6",style:{minWidth:800},maskClosable:!1,closable:!1,cancelText:"\u5173\u95ED\u5F39\u7A97\uFF08\u4E0A\u4F20\u5B8C\u6210\u524D\u8BF7\u4E0D\u8981\u5173\u95ED\uFF09",cancelButtonProps:{danger:!0,type:"primary"}},buttonProps:S()({icon:(0,e.jsx)(ce.Z,{}),children:"\u4E0A\u4F20"},u),children:(0,e.jsx)(Rn,{folder:z(r,"/"),region:t,extra:(0,e.jsx)("span",{style:{color:"red",fontWeight:"bold"},children:"\u70B9\u51FB\u4E0A\u4F20\u6309\u94AE\u5F00\u59CB\u4E0A\u4F20\uFF0C\u4E0A\u4F20\u8FC7\u7A0B\u4E2D\u8BF7\u4E0D\u8981\u5173\u95ED\u5F39\u7A97\u3002\u70B9\u51FB\u52A0\u53F7\u53EF\u4EE5\u540C\u65F6\u4E0A\u4F20\u591A\u4E2A\u6587\u4EF6\u3002"})})})}function Sn(n){var r=n.region,t=n.currentPath,u=n.setLoading,a=n.setLoadingFinished,i=n.cache,l=n.run;return(0,e.jsxs)(A.Z,{style:{justifyContent:"space-between",width:"100%"},children:[(0,e.jsx)(A.Z,{children:(0,e.jsx)(rn,{region:r})}),(0,e.jsxs)(A.Z,{children:[(0,e.jsx)(He,{dir:t,beforeRequest:u,afterRequest:function(c,v){c?T.Z.success({message:"\u521B\u5EFA\u6587\u4EF6\u5939\u6210\u529F"}):T.Z.error({message:"\u521B\u5EFA\u6587\u4EF6\u5939\u5931\u8D25",description:v}),a(),l(t)}}),(0,e.jsx)(un,{disabled:!i,pasteType:(i==null?void 0:i.type)||"copy",src:(i==null?void 0:i.file)||"",dstDir:t,beforeRequest:u,afterRequest:function(c,v){c?T.Z.success({message:"\u7C98\u8D34\u6210\u529F"}):T.Z.error({message:"\u7C98\u8D34\u5931\u8D25",description:v}),a(),l(t)}}),(0,e.jsx)($n,{currentPath:t,region:r})]})]})}function wn(){return ve.apply(this,arguments)}function ve(){return ve=E()(h()().mark(function n(){var r;return h()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,G.post("/api/update");case 2:return r=u.sent,u.abrupt("return",r.data);case 4:case"end":return u.stop()}},n)})),ve.apply(this,arguments)}function bn(n){var r=n.local,t=n.remote,u=g.useState(!1),a=R()(u,2),i=a[0],l=a[1];return(0,e.jsxs)(A.Z,{direction:"vertical",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("span",{children:"\u5F53\u524D\u7248\u672C"})," ",(0,e.jsx)("span",{children:r})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("span",{children:"\u6700\u65B0\u7248\u672C"})," ",(0,e.jsx)("span",{children:t})]}),(0,e.jsx)(O.ZP,{type:"primary",loading:i,onClick:E()(h()().mark(function o(){var c;return h()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return l(!0),d.next=3,wn();case 3:if(c=d.sent,c.success){d.next=8;break}T.Z.error({message:"\u66F4\u65B0\u5931\u8D25",description:"".concat(c.errMsg)}),d.next=12;break;case 8:return T.Z.success({message:"\u66F4\u65B0\u6210\u529F",description:"5 \u79D2\u540E\u81EA\u52A8\u5237\u65B0\u9875\u9762"}),d.next=11,new Promise(function(f){return setTimeout(f,5e3)});case 11:window.location.reload();case 12:l(!1);case 13:case"end":return d.stop()}},o)})),children:"\u4E00\u952E\u66F4\u65B0"})]})}var Pn=s(77123),kn=["path","beforeRequest","afterRequest"];function Dn(n){var r=n.path,t=n.beforeRequest,u=n.afterRequest,a=J()(n,kn),i=g.useMemo(function(){return Ce(r)},[r]),l=g.useState(""),o=R()(l,2),c=o[0],v=o[1];return g.useEffect(function(){return v(ye(r))},[r]),(0,e.jsx)(V,{modalProps:{title:"\u91CD\u547D\u540D\u6587\u4EF6",okText:"\u91CD\u547D\u540D"},buttonProps:S()({icon:(0,e.jsx)(Pn.Z,{}),type:"text"},a),beforeRequest:t,afterRequest:u,request:E()(h()().mark(function d(){return h()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,ge(r,z(Ce(r),c));case 2:return p.abrupt("return",p.sent);case 3:case"end":return p.stop()}},d)})),children:(0,e.jsx)(W.Z,{addonBefore:z(i,"/"),value:c,onChange:function(f){var p;return v((f==null||(p=f.target)===null||p===void 0?void 0:p.value)||"")},style:{width:"100%"}})})}var An={item:"item___RAKFG"};function Tn(){var n=g.useState("/mnt/auto/sd"),r=R()(n,2),t=r[0],u=r[1],a=g.useState(t),i=R()(a,2),l=i[0],o=i[1],c=se.Z(function(){var D=E()(h()().mark(function Z(y){var b,k;return h()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return M.next=2,De(y);case 2:if(b=M.sent,b.success){M.next=6;break}return T.Z.error({message:"\u83B7\u53D6\u6587\u4EF6\u9519\u8BEF",description:b.errMsg}),M.abrupt("return",[]);case 6:return k=b.files||[],o(y),u(y),M.abrupt("return",k.sort(function(K,X){return K.is_dir&&!X.is_dir?-1:!K.is_dir&&X.is_dir?1:K.name.localeCompare(X.name)}));case 10:case"end":return M.stop()}},Z)}));return function(Z){return D.apply(this,arguments)}}(),{retryCount:3,defaultParams:[t]}),v=c.data,d=c.loading,f=c.run,p=ie.Z(!1),F=R()(p,2),j=F[0],I=F[1],C=I.setTrue,B=I.setFalse,$=d||j,L=g.useState(void 0),w=R()(L,2),N=w[0],P=w[1],H=g.useCallback(function(){var D=document.getElementById("scrollableDiv");D&&(D.style.height="".concat(window.innerHeight-D.offsetTop-50,"px"))},[]);g.useEffect(function(){return H()},[]),Ne.Z("resize",H);var Q=se.Z(E()(h()().mark(function D(){return h()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,Te();case 2:return y.abrupt("return",y.sent);case 3:case"end":return y.stop()}},D)}))),x=Q.data;return g.useEffect(function(){(x==null?void 0:x.filemgr_local)!==(x==null?void 0:x.filemgr_remote)&&T.Z.info({duration:10,message:"\u53D1\u73B0\u65B0\u7248\u672C\u6587\u4EF6\u7BA1\u7406\u5668",description:(0,e.jsx)(bn,{local:(x==null?void 0:x.filemgr_local)||"",remote:(x==null?void 0:x.filemgr_remote)||""})})},[x]),g.useEffect(function(){(x==null?void 0:x.with_nas)===!1&&T.Z.warning({message:"\u672A\u6302\u8F7D NAS",description:"\u8BF7\u5728\u8BBE\u7F6E\u4E2D\u6302\u8F7D NAS \u540E\u4F7F\u7528"})},[x==null?void 0:x.with_nas]),(0,e.jsxs)(A.Z,{direction:"vertical",style:{width:"100%"},styles:{item:{width:"100%"}},children:[(0,e.jsx)("h1",{children:"FC File Manager"}),(0,e.jsxs)(A.Z.Compact,{style:{width:"100%"},children:[(0,e.jsx)(W.Z,{value:t,onChange:function(Z){var y;return u((Z==null||(y=Z.target)===null||y===void 0?void 0:y.value)||"")},onKeyDown:function(Z){Z.key==="Enter"&&f(t)}}),(0,e.jsx)(O.ZP,{type:"primary",icon:(0,e.jsx)(Ie.Z,{}),loading:$,onClick:function(){return f(t)}}),(0,e.jsx)(O.ZP,{icon:(0,e.jsx)(Oe.Z,{}),loading:$,onClick:function(){return f(l.split("/").reverse().slice(1).reverse().join("/"))}})]}),(0,e.jsx)(Sn,{region:(x==null?void 0:x.region)||"public",currentPath:l,setLoading:C,setLoadingFinished:B,cache:N,run:f}),(0,e.jsx)("div",{id:"scrollableDiv",style:{height:800,overflow:"auto",padding:"0 16px",border:"1px solid rgba(140, 140, 140, 0.35)",background:"white"},children:(0,e.jsx)(U.Z,{dataSource:v,loading:$,size:"small",renderItem:function(Z){return(0,e.jsx)(U.Z.Item,{children:(0,e.jsxs)(A.Z,{style:{justifyContent:"space-between",width:"100%"},children:[(0,e.jsxs)("div",S()(S()({},Z.is_dir&&{className:An.item,onClick:function(){f("".concat(l.replace(/([\/ ]*)$/g,""),"/").concat(Z.name))}}),{},{children:[Z.is_dir?(0,e.jsx)(Me.Z,{style:{marginRight:"1em",color:"#869aa4"}}):(0,e.jsx)(Le.Z,{style:{marginRight:"1em",color:"#869aa4"}}),Z.name]})),(0,e.jsxs)(A.Z,{children:[!Z.is_dir&&Y(Z.size),(0,e.jsx)(O.ZP,{icon:(0,e.jsx)(Ue.Z,{}),type:"text",onClick:function(){P({file:Z.path,type:"cut"})}}),(0,e.jsx)(O.ZP,{icon:(0,e.jsx)(ze.Z,{}),type:"text",onClick:function(){P({file:Z.path,type:"copy"})}}),(0,e.jsx)(Dn,{path:Z.path,beforeRequest:C,afterRequest:function(b,k){b?T.Z.success({message:"\u91CD\u547D\u540D\u6210\u529F"}):T.Z.error({message:"\u91CD\u547D\u540D\u5931\u8D25",description:k}),B(),f(l)}}),(0,e.jsx)(je.Z,{title:"\u786E\u8BA4\u5220\u9664\u6587\u4EF6?",description:(0,e.jsxs)(le.Z.Text,{children:["\u6587\u4EF6",(0,e.jsx)(le.Z.Text,{code:!0,style:{margin:"0 0.5em"},children:Z.name}),"\u5220\u9664\u540E\u4E0D\u53EF\u6062\u590D"]}),onConfirm:E()(h()().mark(function y(){var b;return h()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return C(),m.prev=1,m.next=4,me(Z.path);case 4:b=m.sent,b.success||T.Z.error({message:"\u5220\u9664\u6587\u4EF6\u9519\u8BEF",description:b.errMsg}),m.next=11;break;case 8:m.prev=8,m.t0=m.catch(1),T.Z.error({message:"\u672A\u77E5\u9519\u8BEF",description:"".concat(m.t0)});case 11:B(),f(l);case 13:case"end":return m.stop()}},y,null,[[1,8]])})),children:(0,e.jsx)(O.ZP,{icon:(0,e.jsx)(Fe.Z,{}),danger:!0,type:"text"})})]})]})})}})})]})}var In=s(17093),On=s(1274),Mn=s(82925),Nn=s(83710);function Ln(){return(0,e.jsx)(In.ZP,{locale:Mn.Z,children:(0,e.jsx)(On.Z,{style:{margin:0,background:"#eee"},children:(0,e.jsx)("div",{className:"flex-lr",style:{flexWrap:"wrap",height:"100vh",width:"100vw",overflow:"hidden",padding:20},children:(0,e.jsx)(Tn,{})})})})}},83710:function(){}}]);
